<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- The 3 meta tags below *must* come first in the head; any other head content must come *after* these tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- More metadata -->
    <meta name="description" content="Free-time Oracle">
    <meta name="author" content="Joyce!">

    <!-- The favicon! -->
    <!-- <link rel="icon" href="./static/favicon.png"> -->

    <!-- The page title -->
    <title>Free-time Oracle</title>

    <!-- Bootstrap core CSS -->
    <link href="./static/deps/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="./static/deps/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- Fancy animations CSS -->
    <link href="./static/deps/animate/animate.min.css" rel="stylesheet">

    <!-- CSS Spinners; see: http://www.css-spinners.com/ -->
    <link rel="stylesheet" href="./static/deps/css-spinners/css/spinners.css">

    <!-- Custom styles for this website -->
    <link href="./static/deps/css_custom/my.css" rel="stylesheet">

    <script>
      GAME_SAMPLES_ENDPOINT_URL = "http://54.205.134.217:5000/mock/games_samples";
    </script>
  </head>

  <body>

    <div class="container">
      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            <li role="presentation" class="active"><a href="#">Home</a></li>
            <li role="presentation"><a href="#">About</a></li>
            <li role="presentation"><a href="#">Contact</a></li>
          </ul>
        </nav>
        <h3 class="text-muted">Free-time Oracle</h3>
      </div>

      <div class="jumbotron">
        <h1>Free-time Oracle</h1>
        <p class="lead">Need to waste some time? Get video game and movie recommendations!</p>
        <p>
          <button type="button" class="btn btn-success btn-lg" autocomplete="off" id="button-begin">Begin</button>
        </p>
      </div>

      <div class="row marketing hidden" id="movie-section">

        <div class="col-sm-6 col-xs-12" style="margin-bottom: 40px">

          <div class="form-group">
            <label for="movie_pos_1">A movie you <span class="text-primary">love</span>:</label>
            <input type="text" class="form-control" id="movie_pos_1" placeholder="">
          </div>
          <div class="form-group">
            <label for="movie_pos_2">A movie you <span class="text-primary">love</span>:</label>
            <input type="text" class="form-control" id="movie_pos_2" placeholder="">
          </div>
          <div class="form-group">
            <label for="movie_pos_3">A movie you <span class="text-primary">love</span>:</label>
            <input type="text" class="form-control" id="movie_pos_3" placeholder="">
          </div>

        </div>

        <div class="col-sm-6 col-xs-12" style="margin-bottom: 40px">

          <div class="form-group">
            <label for="movie_neg_1">A movie you <span class="text-danger">hate</span>:</label>
            <input type="text" class="form-control" id="movie_neg_1" placeholder="">
          </div>
          <div class="form-group">
            <label for="movie_neg_2">A movie you <span class="text-danger">hate</span>:</label>
            <input type="text" class="form-control" id="movie_neg_2" placeholder="">
          </div>
          <div class="form-group">
            <label for="movie_neg_3">A movie you <span class="text-danger">hate</span>:</label>
            <input type="text" class="form-control" id="movie_neg_3" placeholder="">
          </div>

        </div>

        <div class="col-xs-12" style="text-align: center">
          <p>
            <button type="button" class="btn btn-info btn-lg" autocomplete="off" id="button-movies-done">Next</button>
          </p>
        </div>

      </div>

      <div class="row marketing hidden" id="game-section">

        <div class="col-xs-12" style="text-align: center">
          <h3>Do you know any of these games?</h3>
          <h5>(if yes, provide your feedback on a few of them)</h5>
        </div>

        <div id="game-image-container">

          <div class="col-sm-4 col-xs-6 hidden" style="text-align: center" id="game-image-base">
            <div class="game-image-inner" style="padding: 15px; margin: 15px">
              <h4>
                Rating: <button type="button" class="btn btn-danger btn-xs button-bad">bad</button>
                        <button type="button" class="btn btn-primary btn-xs button-good">good</button>
              </h4>
              <p>
                <img src="" class="img-responsive game-image" style="margin: 0 auto">
              </p>
            </div>
          </div>

        </div>

        <div class="col-xs-12" style="text-align: center">
          <p>
            <button type="button" class="btn btn-success btn-lg" autocomplete="off" id="button-games-done">Recommend Stuff!</button>
          </p>
        </div>

      </div>

      <footer class="footer">
        <p>&copy; 2016 Joyce!, Inc.</p>
      </footer>

    </div> <!-- /container -->

    <!-- JQuery -->
    <script src="./static/deps/jquery/jquery-2.1.4.min.js"></script>
    <script src="./static/deps/jquery/jquery.easing.1.3.js"></script>

    <!-- Bootstrap core JavaScript -->
    <script src="./static/deps/bootstrap/js/bootstrap.min.js"></script>
    <script>
        // You have to turn on all tooltips and popovers for them to work:
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
        $(function () {
            $('[data-toggle="popover"]').popover();
        });
    </script>

    <!-- Handy function to scroll the page to a given jquery object: -->
    <script>
        function scroll_to_object(obj, completionFunc)
        {
            setTimeout(function() {
                $('html, body').stop().animate({
                    'scrollTop': obj.offset().top
                }, 900, "easeInOutQuad", completionFunc);
            }, 250);
        }
    </script>

    <!-- Javascript sprintf() -->
    <script src="./static/deps/sprintf/sprintf.min.js"></script>

    <!-- This page's custom JS -->
    <script>

    // Handle when the 'Begin' button is clicked.
    $(function() {
        $('#button-begin').on('click', function(){
          $('#movie-section').removeClass('hidden');
          scroll_to_object($('#movie-section'));
        });
    });

    // Handle when the 'Next' button is clicked (after user enters movie preferences).
    $(function() {
        $('#button-movies-done').on('click', function(){
          $('#game-section').removeClass('hidden');
          scroll_to_object($('#game-section'));
        });
    });

    // State to hold the game preference selection stuff.
    GAME_PREFS = {};

    // Populate the game section when the page loads.
    $(function() {
      $.getJSON(GAME_SAMPLES_ENDPOINT_URL, function(data) {
        var $container = $('#game-image-container');
        var $base = $('#game-image-base');
        var res = data.results;
        for (var i = 0; i < res.length; i++)
        {
          var res_img_url = res[i][0];
          var res_id = res[i][1];

          var $clone = $base.clone();
          $clone.prop('id', 'game-image-' + i);

          var $button_bad = $clone.find('.button-bad');
          var $button_good = $clone.find('.button-good');

          $button_bad.on('click', (function(res_id, $clone) {
            return function() {
              GAME_PREFS[res_id] = false;
              console.log('dislike ' + res_id);
              $inner = $clone.find('.game-image-inner');
              $inner.removeClass('game-good game-bad');
              $inner.addClass('game-bad');
            };
          })(res_id, $clone));

          $button_good.on('click', (function(res_id, $clone) {
            return function() {
              GAME_PREFS[res_id] = true;
              console.log('LIKE ' + res_id);
              $inner = $clone.find('.game-image-inner');
              $inner.removeClass('game-good game-bad');
              $inner.addClass('game-good');
            };
          })(res_id, $clone));

          var $image = $clone.find('.game-image');
          $image.attr("src", res_img_url);

          $clone.removeClass('hidden');
          $container.append($clone);
        }
      });
    });

    // Handle the final 'MAKE RECOMMENDATIONS' button.
    $(function() {
      $('#button-games-done').on('click', function() {
        alert(JSON.stringify(GAME_PREFS));
      });
    });

    </script>

  </body>
</html>
